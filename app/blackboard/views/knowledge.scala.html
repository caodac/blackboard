@import play.twirl.api.HtmlFormat
@import _root_.blackboard.index.pubmed.PubMedIndex._
@import _root_.blackboard.controllers.routes
@(page: Integer, rows: Integer, pages: Array[Int], result: SearchResult)

@paging() = {
  @if(pages.length > 0) {
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      @for(i <- pages) {
        @if(i == 0) {
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">
              <span><i class="fa fa-ellipsis-h"></i></span>
            </a>
          </li>
        }else{
          @if(i == page) {
            <li class="page-item active">
              <a class="page-link" tabindex="-1" href="#">@i
                <span class="sr-only">(current)</span></a></li>
          }else{
            <li class="page-item">
              <a class="page-link" href="@routes.KnowledgeApp.search(result.query.getQuery.toString,(i-1)*rows,rows)">@i</a></li>
          }
        }
      }
    </ul>
  </nav>
  }
}

@views.html.ui.main("NCATS Knowledge: "+result.query.getQuery){
  <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="https://ncats.nih.gov">
      <img src='@controllers.routes.Assets.versioned("images/ncats-logo.png")'
           height="65%" width="65%">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarTogglerDemo02"
            aria-controls="navbarTogglerDemo02"
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
        <li class="nav-item">
          <a class="nav-link" href="@routes.KnowledgeApp.index">Home</a>
        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0" method="GET"
            action="@routes.KnowledgeApp.search(null)">
        <input class="form-control mr-sm-2" type="search" name="q"
               placeholder="Enter search terms..." style="width:20em">
        <button class="btn btn-primary my-2 my-sm-0"
                type="submit" style="border-radius:3rem">Search</button>
      </form>
    </div>
  </nav>  
  <div class="container-fluid" style="margin-top: 55px; margin-bottom:10px;">
    <div class="row">
      <div class="col-md-3">
        @** FILTERS **@
        @facetcard("Year_Published", result.getFacet("@year"))
        @facetcard("Author", result.getFacet("@author"))
        @facetcard("Article_Type", result.getFacet("@pubtype"))
        @facetcard("Journal", result.getFacet("@journal"))
        @facetcard("Keyword", result.getFacet("@keyword"))
        @facetcard("Concept", result.getFacet("@cui"), false)
        @facetcard("MeSH", result.getFacet("@ui"), false)
      </div>
      <div class="col-md-6">
        @** SEARCH CONTENTS **@
        @for(d <- result.docs) {
          @articlecard(d)
          }
          <div class="alert fade show" role="alert">
            @paging()
          </div>
      </div>
      <div class="col-md-3">
        @** CONTEXT **@
        @contextcard(result.query){
          @result.total documents matched
          }
      </div>
    </div>
  </div>
  }{
  }{
   $(document).ready(function() {
     //$('[data-toggle="tooltip"]').tooltip();
   });
  }
